/*! premise-time-track 2017-02-10 */
!function(a){function b(){function b(){i.html(l)}function c(a){return i.html(a),d(),k&&o(),!1}function d(){var b=0;a(".pwptt-time-card-time").each(function(){b=parseFloat(a(this).text())+parseFloat(b),j.html(b)})}var e,f=a("#pwptt-loop-wrapper"),g=a(".pwptt-search"),h=a("#pwptt-quick-change"),i=a("#pwptt-body"),j=a(".pwptt-total-hours"),k=a(".iframe").length,l='<p class="pwptt-loading"><i class="fa fa-spin fa-spinner"></i></p>',m=pwptt_localized.wpajaxurl,n=function(){k&&(window.addEventListener("message",p,!1),o()),f.length?q():!1},o=function(){a(".pwptt-iframe-edit a").on("click",function(b){b.preventDefault();var c=a(this).attr("href");return e.postMessage(c,"*"),!1})},p=function(a){console.log(a.origin),"edit"===a.data&&(e=a.source,window.removeEventListener("message",p))},q=function(){g.length&&(g.change(r),g.keyup(function(a){13===a.keyCode?r:!1})),h.length&&h.change(function(d){d.preventDefault(),b(),g.val("");var e={action:"ptt_search_timers",quick_change:a(this).val(),taxonomy:g.attr("data-tax"),slug:g.attr("data-slug")};return k&&(e.iframe=!0),a.post(m,e,c),!1})},r=function(){var d=a(this),e=d.val()?d.val():"",f=d.attr("data-tax"),g=d.attr("data-slug"),h=new RegExp("^(([0-9]{1,2})/([0-9]{1,2})/([0-9]{2,4})) ?(-) ?(([0-9]{1,2})/([0-9]{1,2})/([0-9]{2,4}))$","g"),i=e.match(h);if(i){b();var j=i[0].split("-"),l={action:"ptt_search_timers",taxonomy:f,slug:g,date_range:{from:j[0],to:j[1]}};k&&(l.iframe=!0),a.post(m,l,c)}return!1};n()}a(document).ready(function(){b()})}(jQuery);