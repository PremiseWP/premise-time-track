/*! premise-time-track 2017-05-15 */
!function(a){function b(){function b(){j.html(m)}function c(a){return j.html(a),d(),l&&p(),!1}function d(){var b=0;a(".pwptt-time-card-time").each(function(){b=parseFloat(a(this).text())+parseFloat(b),k.html(b)})}var e,f=a("#pwptt-loop-wrapper"),g=a(".pwptt-search"),h=a("#pwptt-quick-change"),i=a("#pwptt-author"),j=a("#pwptt-body"),k=a(".pwptt-total-hours"),l=a(".iframe").length,m='<p class="pwptt-loading"><i class="fa fa-spin fa-spinner"></i></p>',n=pwptt_localized.wpajaxurl,o=function(){l&&(window.addEventListener("message",q,!1),p()),f.length?r():!1},p=function(){a(".pwptt-iframe-edit a").on("click",function(b){b.preventDefault();var c=a(this).attr("href");return e.postMessage(c,"*"),!1})},q=function(a){console.log(a.origin),"edit"===a.data&&(e=a.source,window.removeEventListener("message",q))},r=function(){g.length&&(g.change(s),g.keyup(function(a){13===a.keyCode?s:!1})),h.length&&h.change(function(d){d.preventDefault(),b(),g.val("");var e={action:"ptt_search_timers",quick_change:a(this).val(),taxonomy:g.attr("data-tax"),slug:g.attr("data-slug")};return l&&(e.iframe=!0),a.post(n,e,c),!1}),i.length&&i.change(function(d){d.preventDefault(),b(),g.val("");var e={action:"ptt_search_timers",author:a(this).val(),taxonomy:g.attr("data-tax"),slug:g.attr("data-slug")};return l&&(e.iframe=!0),a.post(n,e,c),!1})},s=function(){var d=a(this),e=d.val()?d.val():"",f=d.attr("data-tax"),g=d.attr("data-slug"),h=new RegExp("^(([0-9]{1,2})/([0-9]{1,2})/([0-9]{2,4})) ?(-) ?(([0-9]{1,2})/([0-9]{1,2})/([0-9]{2,4}))$","g"),i=e.match(h);if(i){b();var j=i[0].split("-"),k={action:"ptt_search_timers",taxonomy:f,slug:g,date_range:{from:j[0],to:j[1]}};l&&(k.iframe=!0),window.history.pushState({},"title","?range="+j[0].trim()+"-"+j[1].trim()),a.post(n,k,c)}return!1};o()}a(document).ready(function(){b()})}(jQuery);